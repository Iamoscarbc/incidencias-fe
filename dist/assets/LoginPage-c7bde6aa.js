import{d as w,I as h,a as y,b as k,c as C,e as F,f as S,g as $,u as B,h as N,i as P,r as b,p as L,_ as z,j as s,o as A,k as O,w as l,l as i,m as d,n as R,q as T,s as U}from"./index-35ea6de4.js";import{a as V}from"./axios-3342bc3c.js";const j=w({components:{IonButton:h,IonContent:y,IonIcon:k,IonInput:C,IonItem:F,IonList:S,IonPage:$},setup(){const o=B(),e=N();P();const t=b(""),r=b(""),u=b(!1),g=async()=>{if(u.value)try{let n={docnumber:t.value,password:r.value};const f=(await V.post("/api/auth/login",n)).data;if(f.success){localStorage.setItem("token",f.token);const v=(await V.get("/api/auth/user",{headers:{Authorization:"Bearer "+f.token}})).data;v.success&&(await o.dispatch("usuarios/login",v.user),e.replace({name:"Tab1"}))}}catch(n){console.error("Error en la solicitud:",n)}},p=/^\d{8}$/,c=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/,m=()=>{u.value=p.test(t.value)&&c.test(r.value)},_=async n=>{t.value.length>n&&(t.value=t.value.substr(0,n))};return localStorage.removeItem("token"),{docnumber:t,password:r,isFormValid:u,login:g,updateFormValidity:m,validateNumber:_,personCircleOutline:L}}});const I=o=>(T("data-v-1cab09bf"),o=o(),U(),o),q={class:"login-container"},x=I(()=>d("h2",{class:"login-title"},"Iniciar Sesión",-1)),D=I(()=>d("div",{slot:"label"},"DNI",-1)),E=I(()=>d("div",{slot:"label"},"Contraseña",-1));function Z(o,e,t,r,u,g){const p=s("ion-icon"),c=s("ion-input"),m=s("ion-button"),_=s("ion-content"),n=s("ion-page");return A(),O(n,null,{default:l(()=>[i(_,{class:"ion-padding"},{default:l(()=>[d("div",q,[i(p,{class:"login-icon",icon:o.personCircleOutline},null,8,["icon"]),x,i(c,{modelValue:o.docnumber,"onUpdate:modelValue":e[0]||(e[0]=a=>o.docnumber=a),"label-placement":"floating",fill:"outline",onInput:o.updateFormValidity,type:"number",onIonBlur:e[1]||(e[1]=a=>o.validateNumber(8))},{default:l(()=>[D]),_:1},8,["modelValue","onInput"]),i(c,{modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=a=>o.password=a),"label-placement":"floating",fill:"outline",onInput:o.updateFormValidity,type:"password"},{default:l(()=>[E]),_:1},8,["modelValue","onInput"]),i(m,{expand:"full",onClick:o.login,disabled:!o.isFormValid},{default:l(()=>[R("Iniciar Sesión")]),_:1},8,["onClick","disabled"])])]),_:1})]),_:1})}const K=z(j,[["render",Z],["__scopeId","data-v-1cab09bf"]]);export{K as default};
