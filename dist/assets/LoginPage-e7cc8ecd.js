import{d as h,I as w,a as y,b as k,c as C,e as F,f as S,g as $,u as B,h as N,i as P,r as f,p as L,_ as z,j as a,o as A,k as O,w as l,l as i,m as c,n as R,q as T,s as U}from"./index-2468b0ee.js";import{a as V}from"./axios-f9cbc706.js";const j=h({components:{IonButton:w,IonContent:y,IonIcon:k,IonInput:C,IonItem:F,IonList:S,IonPage:$},setup(){const o=B(),e=N();P();const t=f(""),r=f(""),u=f(!1),g=async()=>{if(u.value)try{let n={docnumber:t.value,password:r.value};const b=(await V.post("http://206.189.176.12:3002/api/auth/login",n)).data;if(b.success){localStorage.setItem("token",b.token);const v=(await V.get("http://206.189.176.12:3002/api/auth/user",{headers:{Authorization:"Bearer "+b.token}})).data;v.success&&(await o.dispatch("usuarios/login",v.user),e.replace({name:"Tab1"}))}}catch(n){console.error("Error en la solicitud:",n)}},p=/^\d{8}$/,d=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/,m=()=>{u.value=p.test(t.value)&&d.test(r.value)},_=async n=>{t.value.length>n&&(t.value=t.value.substr(0,n))};return localStorage.removeItem("token"),{docnumber:t,password:r,isFormValid:u,login:g,updateFormValidity:m,validateNumber:_,personCircleOutline:L}}});const I=o=>(T("data-v-8bb64489"),o=o(),U(),o),q={class:"login-container"},x=I(()=>c("h2",{class:"login-title"},"Iniciar Sesión",-1)),D=I(()=>c("div",{slot:"label"},"DNI",-1)),E=I(()=>c("div",{slot:"label"},"Contraseña",-1));function Z(o,e,t,r,u,g){const p=a("ion-icon"),d=a("ion-input"),m=a("ion-button"),_=a("ion-content"),n=a("ion-page");return A(),O(n,null,{default:l(()=>[i(_,{class:"ion-padding"},{default:l(()=>[c("div",q,[i(p,{class:"login-icon",icon:o.personCircleOutline},null,8,["icon"]),x,i(d,{modelValue:o.docnumber,"onUpdate:modelValue":e[0]||(e[0]=s=>o.docnumber=s),"label-placement":"floating",fill:"outline",onInput:o.updateFormValidity,type:"number",onIonBlur:e[1]||(e[1]=s=>o.validateNumber(8))},{default:l(()=>[D]),_:1},8,["modelValue","onInput"]),i(d,{modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=s=>o.password=s),"label-placement":"floating",fill:"outline",onInput:o.updateFormValidity,type:"password"},{default:l(()=>[E]),_:1},8,["modelValue","onInput"]),i(m,{expand:"full",onClick:o.login,disabled:!o.isFormValid},{default:l(()=>[R("Iniciar Sesión")]),_:1},8,["onClick","disabled"])])]),_:1})]),_:1})}const K=z(j,[["render",Z],["__scopeId","data-v-8bb64489"]]);export{K as default};
